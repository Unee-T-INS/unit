sudo: required
language: go

before_install:
  - curl -sf https://up.apex.sh/install | sudo sh
  - sudo up upgrade
  - pip install --user awscli

install:
  - go get -t ./...
  - sudo apt-get install jq -y

script:
  - go test -v ./...

deploy:
  # dev
  - provider: script
    script: TRAVIS_PROFILE=$AWS_PROFILE_DEV TRAVIS_AWS_ACCESS_KEY_ID=$AWS_ACCOUNT_USER_ID_DEV TRAVIS_AWS_SECRET_ACCESS_KEY=$AWS_ACCOUNT_SECRET_DEV TRAVIS_AWS_DEFAULT_REGION=$AWS_DEFAULT_REGION ./deploy.sh dev
    skip_cleanup: true
    on:
      branch: remove_hard_coded_variables

env:
  - GO111MODULE=on
